<!DOCTYPE html>
<html>
  <body>
    <cfwebsocket name="socket" onmessage="messageHandler" onopen="openHandler">
    <canvas id="canvasElement" style="border: solid 1px;" width="426" height="240"></canvas>
  </body>
  <script type="text/javascript">
    var canvas, context, count = 0, flag = false;
    var newImage = new Image();

    document.addEventListener('DOMContentLoaded', function(){
      canvas = document.getElementById('canvasElement');
      context = canvas.getContext('2d');
    });

    function openHandler(){
      socket.subscribe("myChannel", {}, dataHandler);
    };

    function messageHandler(msg){
    }

    function dataHandler(msg){
      if (msg.type == 'data') {
        newImage.onload = function(){
          context.drawImage(newImage, 0, 0);
          flag = true;
          count = 1;
        }

        if (count == 0 || flag == true) {
          flag = false;
          newImage.src = msg.data;
        }
      }
    }
  </script>
</html>